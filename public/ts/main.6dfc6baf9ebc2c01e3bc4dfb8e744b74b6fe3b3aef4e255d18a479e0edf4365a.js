(()=>{var v=class t{galleryUID;items=[];constructor(e,n=1){if(window.PhotoSwipe==null||window.PhotoSwipeUI_Default==null){console.error("PhotoSwipe lib not loaded.");return}this.galleryUID=n,t.createGallery(e),this.loadItems(e),this.bindClick()}loadItems(e){this.items=[];let n=e.querySelectorAll("figure.gallery-image");for(let o of n){let s=o.querySelector("figcaption"),i=o.querySelector("img"),r={w:parseInt(i.getAttribute("width")),h:parseInt(i.getAttribute("height")),src:i.src,msrc:i.getAttribute("data-thumb")||i.src,el:o};s&&(r.title=s.innerHTML),this.items.push(r)}}static createGallery(e){let n=e.querySelectorAll("img.gallery-image");for(let i of Array.from(n)){let r=i.closest("p");if(!r||!e.contains(r)||(r.textContent.trim()==""&&r.classList.add("no-text"),!r.classList.contains("no-text")))continue;let d=i.parentElement.tagName=="A",u=i,c=document.createElement("figure");if(c.style.setProperty("flex-grow",i.getAttribute("data-flex-grow")||"1"),c.style.setProperty("flex-basis",i.getAttribute("data-flex-basis")||"0"),d&&(u=i.parentElement),u.parentElement.insertBefore(c,u),c.appendChild(u),i.hasAttribute("alt")){let a=document.createElement("figcaption");a.innerText=i.getAttribute("alt"),c.appendChild(a)}if(!d){c.className="gallery-image";let a=document.createElement("a");a.href=i.src,a.setAttribute("target","_blank"),i.parentNode.insertBefore(a,i),a.appendChild(i)}}let o=e.querySelectorAll("figure.gallery-image"),s=[];for(let i of o)s.length?i.previousElementSibling===s[s.length-1]?s.push(i):s.length&&(t.wrap(s),s=[i]):s=[i];s.length>0&&t.wrap(s)}static wrap(e){let n=document.createElement("div");n.className="gallery";let o=e[0].parentNode,s=e[0];o.insertBefore(n,s);for(let i of e)n.appendChild(i)}open(e){let n=document.querySelector(".pswp");new window.PhotoSwipe(n,window.PhotoSwipeUI_Default,this.items,{index:e,galleryUID:this.galleryUID,getThumbBoundsFn:s=>{let i=this.items[s].el.getElementsByTagName("img")[0],r=window.pageYOffset||document.documentElement.scrollTop,m=i.getBoundingClientRect();return{x:m.left,y:m.top+r,w:m.width}}}).init()}bindClick(){for(let[e,n]of this.items.entries())n.el.querySelector("a").addEventListener("click",s=>{s.preventDefault(),this.open(e)})}},E=v;var h={};if(localStorage.hasOwnProperty("StackColorsCache"))try{h=JSON.parse(localStorage.getItem("StackColorsCache"))}catch{h={}}async function L(t,e,n){if(!t)return await Vibrant.from(n).getPalette();if(!h.hasOwnProperty(t)||h[t].hash!==e){let o=await Vibrant.from(n).getPalette();h[t]={hash:e,Vibrant:{hex:o.Vibrant.hex,rgb:o.Vibrant.rgb,bodyTextColor:o.Vibrant.bodyTextColor},DarkMuted:{hex:o.DarkMuted.hex,rgb:o.DarkMuted.rgb,bodyTextColor:o.DarkMuted.bodyTextColor}},localStorage.setItem("StackColorsCache",JSON.stringify(h))}return h[t]}var K=(t,e=500)=>{t.classList.add("transiting"),t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=t.offsetHeight+"px",t.offsetHeight,t.style.overflow="hidden",t.style.height="0",t.style.paddingTop="0",t.style.paddingBottom="0",t.style.marginTop="0",t.style.marginBottom="0",window.setTimeout(()=>{t.classList.remove("show"),t.style.removeProperty("height"),t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("transiting")},e)},O=(t,e=500)=>{t.classList.add("transiting"),t.style.removeProperty("display"),t.classList.add("show");let n=t.offsetHeight;t.style.overflow="hidden",t.style.height="0",t.style.paddingTop="0",t.style.paddingBottom="0",t.style.marginTop="0",t.style.marginBottom="0",t.offsetHeight,t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=n+"px",t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),window.setTimeout(()=>{t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("transiting")},e)},U=(t,e=500)=>window.getComputedStyle(t).display==="none"?O(t,e):K(t,e);function A(){let t=document.getElementById("toggle-menu");t&&t.addEventListener("click",()=>{document.getElementById("main-menu").classList.contains("transiting")||(document.body.classList.toggle("show-menu"),U(document.getElementById("main-menu"),300),t.classList.toggle("is-active"))})}function V(t,e,n){var o=document.createElement(t);for(let s in e)if(s&&e.hasOwnProperty(s)){let i=e[s];s=="dangerouslySetInnerHTML"?o.innerHTML=i.__html:i===!0?o.setAttribute(s,s):i!==!1&&i!=null&&o.setAttribute(s,i.toString())}for(let s=2;s<arguments.length;s++){let i=arguments[s];i&&o.appendChild(i.nodeType==null?document.createTextNode(i.toString()):i)}return o}var T=V;var b=class{localStorageKey="StackColorScheme";currentScheme;systemPreferScheme;constructor(e){this.bindMatchMedia(),this.currentScheme=this.getSavedScheme(),window.matchMedia("(prefers-color-scheme: dark)").matches===!0?this.systemPreferScheme="dark":this.systemPreferScheme="light",this.dispatchEvent(document.documentElement.dataset.scheme),e&&this.bindClick(e),document.body.style.transition==""&&document.body.style.setProperty("transition","background-color .3s ease")}saveScheme(){localStorage.setItem(this.localStorageKey,this.currentScheme)}bindClick(e){e.addEventListener("click",n=>{this.isDark()?this.currentScheme="light":this.currentScheme="dark",this.setBodyClass(),this.currentScheme==this.systemPreferScheme&&(this.currentScheme="auto"),this.saveScheme()})}isDark(){return this.currentScheme=="dark"||this.currentScheme=="auto"&&this.systemPreferScheme=="dark"}dispatchEvent(e){let n=new CustomEvent("onColorSchemeChange",{detail:e});window.dispatchEvent(n)}setBodyClass(){this.isDark()?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light",this.dispatchEvent(document.documentElement.dataset.scheme)}getSavedScheme(){let e=localStorage.getItem(this.localStorageKey);return e=="light"||e=="dark"||e=="auto"?e:"auto"}bindMatchMedia(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?this.systemPreferScheme="dark":this.systemPreferScheme="light",this.setBodyClass()})}},k=b;function y(t){let e;return()=>{e&&window.cancelAnimationFrame(e),e=window.requestAnimationFrame(()=>t())}}var R=".article-content h1[id], .article-content h2[id], .article-content h3[id], .article-content h4[id], .article-content h5[id], .article-content h6[id]",x="#TableOfContents",M="#TableOfContents li",I="active-class";function $(t,e){let n=t.querySelector("a").offsetHeight,o=t.offsetTop-e.offsetHeight/2+n/2-e.offsetTop;o<0&&(o=0),e.scrollTo({top:o,behavior:"smooth"})}function F(t){let e={};return t.forEach(n=>{let s=n.querySelector("a").getAttribute("href");s.startsWith("#")&&(e[s.slice(1)]=n)}),e}function C(t){let e=[];return t.forEach(n=>{e.push({id:n.id,offset:n.offsetTop})}),e.sort((n,o)=>n.offset-o.offset),e}function B(){let t=document.querySelectorAll(R);if(!t){console.warn("No header matched query",t);return}let e=document.querySelector(x);if(!e){console.warn("No toc matched query",x);return}let n=document.querySelectorAll(M);if(!n){console.warn("No navigation matched query",M);return}let o=C(t),s=!1;e.addEventListener("mouseenter",y(()=>s=!0)),e.addEventListener("mouseleave",y(()=>s=!1));let i,r=F(n);function m(){let u=document.documentElement.scrollTop||document.body.scrollTop,c;o.forEach(f=>{u>=f.offset-20&&(c=document.getElementById(f.id))});let a;c&&(a=r[c.id]),c&&!a?console.debug("No link found for section",c):a!==i&&(i&&i.classList.remove(I),a&&(a.classList.add(I),s||$(a,e)),i=a)}window.addEventListener("scroll",y(m));function d(){o=C(t),m()}window.addEventListener("resize",y(d))}var Q="a[href]";function P(){document.querySelectorAll(Q).forEach(t=>{t.getAttribute("href").startsWith("#")&&t.addEventListener("click",n=>{n.preventDefault();let o=decodeURI(t.getAttribute("href").substring(1)),s=document.getElementById(o),i=s.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;window.history.pushState({},"",t.getAttribute("href")),scrollTo({top:i,behavior:"smooth"})})})}var S=class{localStorageKey="StackAdminAuth";attemptsKey="StackAuthAttempts";timestampKey="StackAuthTimestamp";currentStatus;config;constructor(e){this.config={adminPassword:"admit",sessionTimeout:24*60*60*1e3,maxLoginAttempts:5,...e},this.currentStatus=this.getSavedAuthStatus(),this.cleanupExpiredSession(),this.dispatchAuthEvent(this.currentStatus)}authenticate(e){return this.isBlocked()?(this.dispatchAuthEvent("blocked"),!1):e===this.config.adminPassword?(this.currentStatus="authenticated",this.saveAuthStatus(),this.clearLoginAttempts(),this.dispatchAuthEvent("authenticated"),!0):(this.incrementLoginAttempts(),this.dispatchAuthEvent("failed"),!1)}logout(){this.currentStatus="guest",this.clearAuthData(),this.dispatchAuthEvent("guest")}isAuthenticated(){return this.isSessionExpired()?(this.logout(),!1):this.currentStatus==="authenticated"}isAdmin(){return this.isAuthenticated()}getStatus(){return this.currentStatus}isBlocked(){return this.getLoginAttempts()>=this.config.maxLoginAttempts}getRemainingAttempts(){let e=this.getLoginAttempts();return Math.max(0,this.config.maxLoginAttempts-e)}resetLoginAttempts(){this.clearLoginAttempts()}saveAuthStatus(){localStorage.setItem(this.localStorageKey,this.currentStatus),localStorage.setItem(this.timestampKey,Date.now().toString())}getSavedAuthStatus(){return localStorage.getItem(this.localStorageKey)==="authenticated"?"authenticated":"guest"}isSessionExpired(){let e=localStorage.getItem(this.timestampKey);if(!e)return!0;let n=parseInt(e);return Date.now()-n>this.config.sessionTimeout}cleanupExpiredSession(){this.isSessionExpired()&&(this.clearAuthData(),this.currentStatus="guest")}clearAuthData(){localStorage.removeItem(this.localStorageKey),localStorage.removeItem(this.timestampKey)}getLoginAttempts(){let e=localStorage.getItem(this.attemptsKey);return e?parseInt(e):0}incrementLoginAttempts(){let e=this.getLoginAttempts()+1;localStorage.setItem(this.attemptsKey,e.toString())}clearLoginAttempts(){localStorage.removeItem(this.attemptsKey)}dispatchAuthEvent(e){let n=new CustomEvent("onAuthStatusChange",{detail:{status:e,isAuthenticated:this.isAuthenticated(),isAdmin:this.isAdmin(),remainingAttempts:this.getRemainingAttempts()}});window.dispatchEvent(n)}},l={toggleAdminElements:t=>{let e=document.querySelectorAll("[data-admin-only]"),n=document.querySelectorAll("[data-guest-only]");e.forEach(o=>{o.style.display=t?"":"none"}),n.forEach(o=>{o.style.display=t?"none":""})},updateBodyClass:t=>{t?(document.body.classList.add("admin-mode"),document.body.classList.remove("guest-mode")):(document.body.classList.add("guest-mode"),document.body.classList.remove("admin-mode"))},createLoginModal:()=>`
            <div id="admin-login-modal" class="admin-modal" style="display: none;">
                <div class="admin-modal-content">
                    <div class="admin-modal-header">
                        <h3>
                            <div class="admin-icon-wrapper">
                                <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                    <circle cx="12" cy="16" r="1"></circle>
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                                </svg>
                            </div>
                            <span class="admin-title-text">\u7BA1\u7406\u5458\u767B\u5F55</span>
                        </h3>
                        <button class="admin-modal-close" id="admin-modal-close" type="button" aria-label="\u5173\u95ED\u767B\u5F55\u7A97\u53E3">
                            <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </button>
                    </div>
                    <div class="admin-modal-body">
                        <form id="admin-login-form" novalidate>
                            <div class="admin-form-group">
                                <label for="admin-password">
                                    <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                        <circle cx="12" cy="16" r="1"></circle>
                                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                                    </svg>
                                    \u7BA1\u7406\u5458\u5BC6\u7801
                                </label>
                                <input
                                    type="password"
                                    id="admin-password"
                                    name="password"
                                    placeholder="\u8BF7\u8F93\u5165\u7BA1\u7406\u5458\u5BC6\u7801"
                                    autocomplete="current-password"
                                    required
                                    aria-describedby="admin-login-error admin-login-attempts"
                                >
                            </div>
                            <div class="admin-form-actions">
                                <button type="submit" id="admin-login-btn" class="admin-btn admin-btn-primary">
                                    <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                                        <polyline points="10,17 15,12 10,7"></polyline>
                                        <line x1="15" y1="12" x2="3" y2="12"></line>
                                    </svg>
                                    \u767B\u5F55
                                </button>
                                <button type="button" id="admin-cancel-btn" class="admin-btn admin-btn-secondary">
                                    <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18"></line>
                                        <line x1="6" y1="6" x2="18" y2="18"></line>
                                    </svg>
                                    \u53D6\u6D88
                                </button>
                            </div>
                            <div id="admin-login-error" class="admin-error" style="display: none;" role="alert" aria-live="polite">
                                <!-- Error message will be inserted here -->
                            </div>
                            <div id="admin-login-attempts" class="admin-info" style="display: none;" role="status" aria-live="polite">
                                <!-- Attempts info will be inserted here -->
                            </div>
                        </form>
                        <div class="admin-login-help">
                            <p class="admin-help-text">
                                <svg class="admin-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                                </svg>
                                \u63D0\u793A\uFF1A\u4F7F\u7528\u5FEB\u6377\u952E <kbd>Ctrl + Alt + A</kbd> \u53EF\u5FEB\u901F\u6253\u5F00\u767B\u5F55\u7A97\u53E3
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        `,showLoginModal:()=>{let t=document.getElementById("admin-login-modal");if(t)t.style.display="flex",l.clearMessages(),setTimeout(()=>{let e=document.getElementById("admin-password");e&&(e.focus(),e.select())},150);else{console.warn("Admin login modal not found. Creating modal...");let e=l.createLoginModal();document.body.insertAdjacentHTML("beforeend",e),setTimeout(()=>l.showLoginModal(),100)}},hideLoginModal:()=>{let t=document.getElementById("admin-login-modal");if(t){t.style.display="none";let e=document.getElementById("admin-login-form");e&&e.reset();let n=document.getElementById("admin-login-error"),o=document.getElementById("admin-login-attempts");n&&(n.style.display="none"),o&&(o.style.display="none")}},showLoginError:t=>{let e=document.getElementById("admin-login-error");e&&(e.textContent=t,e.style.display="block")},showAttemptsInfo:t=>{let e=document.getElementById("admin-login-attempts");e&&(e.textContent=`\u5269\u4F59\u5C1D\u8BD5\u6B21\u6570: ${t}`,e.style.display="block")},setLoginButtonLoading:t=>{let e=document.getElementById("admin-login-btn");e&&(t?(e.disabled=!0,e.classList.add("loading")):(e.disabled=!1,e.classList.remove("loading")))},clearMessages:()=>{let t=document.getElementById("admin-login-error"),e=document.getElementById("admin-login-attempts");t&&(t.style.display="none"),e&&(e.style.display="none")},validatePassword:t=>t?t.length<1?{valid:!1,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"}:{valid:!0}:{valid:!1,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}},H=S;var g,w={init:()=>{g=new H,window.addEventListener("onAuthStatusChange",i=>{let{status:r,isAuthenticated:m,isAdmin:d,remainingAttempts:u}=i.detail;switch(l.toggleAdminElements(d),l.updateBodyClass(d),r){case"authenticated":l.hideLoginModal(),console.log("Admin authenticated successfully");break;case"failed":l.showLoginError("\u5BC6\u7801\u9519\u8BEF"),u>0&&l.showAttemptsInfo(u);break;case"blocked":l.showLoginError("\u767B\u5F55\u5C1D\u8BD5\u6B21\u6570\u8FC7\u591A\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5");break;case"guest":console.log("User logged out or session expired");break}}),setTimeout(()=>{let i=l.createLoginModal();document.body.insertAdjacentHTML("beforeend",i),w.bindAuthEvents();let r=g.isAuthenticated();l.toggleAdminElements(r),l.updateBodyClass(r)},100),A();let t=document.querySelector(".article-content");t&&(new E(t),P(),B());let e=document.querySelector(".article-list--tile");e&&new IntersectionObserver(async(r,m)=>{r.forEach(d=>{if(!d.isIntersecting)return;m.unobserve(d.target),d.target.querySelectorAll("article.has-image").forEach(async c=>{let a=c.querySelector("img"),f=a.src,D=a.getAttribute("data-key"),q=a.getAttribute("data-hash"),N=c.querySelector(".article-details"),p=await L(D,q,f);N.style.background=`
                        linear-gradient(0deg, 
                            rgba(${p.DarkMuted.rgb[0]}, ${p.DarkMuted.rgb[1]}, ${p.DarkMuted.rgb[2]}, 0.5) 0%, 
                            rgba(${p.Vibrant.rgb[0]}, ${p.Vibrant.rgb[1]}, ${p.Vibrant.rgb[2]}, 0.75) 100%)`})})}).observe(e);let n=document.querySelectorAll(".article-content div.highlight"),o="Copy",s="Copied!";n.forEach(i=>{let r=document.createElement("button");r.innerHTML=o,r.classList.add("copyCodeButton"),i.appendChild(r);let m=i.querySelector("code[data-lang]");m&&r.addEventListener("click",()=>{navigator.clipboard.writeText(m.textContent).then(()=>{r.textContent=s,setTimeout(()=>{r.textContent=o},1e3)}).catch(d=>{alert(d),console.log("Something went wrong",d)})})}),new k(document.getElementById("dark-mode-toggle"))},bindAuthEvents:()=>{let t=document.getElementById("admin-login-form");t&&t.addEventListener("submit",i=>{i.preventDefault();let r=document.getElementById("admin-password");r&&g.authenticate(r.value)});let e=document.getElementById("admin-modal-close"),n=document.getElementById("admin-cancel-btn");e&&e.addEventListener("click",()=>{l.hideLoginModal()}),n&&n.addEventListener("click",()=>{l.hideLoginModal()});let o=document.getElementById("admin-login-modal");o&&o.addEventListener("click",i=>{i.target===o&&l.hideLoginModal()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&l.hideLoginModal()});let s=document.getElementById("admin-panel-toggle");s&&s.addEventListener("click",i=>{i.preventDefault(),console.log("Admin panel toggle clicked - functionality to be implemented")})},getAuth:()=>g,showLogin:()=>{l.showLoginModal()},logout:()=>{g&&g.logout()}};window.addEventListener("load",()=>{setTimeout(function(){w.init()},0)});window.Stack=w;window.createElement=T;window.StackAuth=g;})();
/*!
*   Hugo Theme Stack - Authentication Module
*
*   @author: Emma (Product Manager)
*   @project: Hugo Blog Admin System
*   @description: Admin authentication and permission management
*/
/*!
*   Hugo Theme Stack - Extended with Admin Authentication
*
*   @author: Jimmy Cai (Original), Emma (Admin Extension)
*   @website: https://jimmycai.com
*   @link: https://github.com/CaiJimmy/hugo-theme-stack
*/
